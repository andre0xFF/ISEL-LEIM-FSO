package tester;

import java.util.concurrent.TimeUnit;

import robot.MyRobotLego;

public class test 
{
	public static void main(String[] args) throws InterruptedException {
		escapeTest();
	}
	
	public static MyRobotLego connectWithRobot() throws InterruptedException {
		MyRobotLego robot = new MyRobotLego();
		
		robot.OpenNXT("FSO1");
		Thread.sleep(10000);
		System.out.println("GO!");
		return robot;
	}
	
	public static void disconnectFromRobot(MyRobotLego robot) throws InterruptedException {
		Thread.sleep(1000);
		robot.CloseNXT();
	}
	
	public static void backScannerTest() throws InterruptedException {
		MyRobotLego robot = connectWithRobot();
		
		robot.SetSensorLowspeed(0);
		for(int i = 0; i < 60; i++) {
			System.out.println(robot.SensorUS(0));
			Thread.sleep(500);
		}
	}
	
	public static void escapeTest() throws InterruptedException {
		MyRobotLego robot = connectWithRobot();
		
		robot.escape(5, 100);
		Thread.sleep(10 * 60 * 1000);
		
		disconnectFromRobot(robot);	
	}
	
	public static void roamTest() throws InterruptedException {
		MyRobotLego robot = connectWithRobot();
		
		robot.roam();
		Thread.sleep(10000);
		robot.roam();
		
		disconnectFromRobot(robot);		
	}
	
	public static void calculateSpeed() throws InterruptedException {
		MyRobotLego robot = new MyRobotLego();
		
		robot.OpenNXT("FSO1");
		Thread.sleep(10000);
		
		robot.SetSensorLowspeed(MyRobotLego.BACK_SCANNER_PORT);
		int initialDistance = robot.SensorUS(MyRobotLego.BACK_SCANNER_PORT);
		int finalDistance = initialDistance;
		long initialTime = System.nanoTime();
			
		robot.SetSpeed(50);
		robot.AjustarVME(4);
		robot.AjustarVMD(0);
		
		robot.Reta(100);
		robot.Parar(false);
		
		while((finalDistance - initialDistance) < 100) {
			Thread.sleep(50);
			finalDistance = robot.SensorUS(MyRobotLego.BACK_SCANNER_PORT);
			System.out.print((finalDistance - initialDistance) + " ");
		}
		
		long finalTime = System.nanoTime();
		
		System.out.println("");
		System.out.println("Travelled distance: " + (finalDistance - initialDistance));
		System.out.println("Elapsed time: " + TimeUnit.NANOSECONDS.toSeconds((finalTime - initialTime)));
		
		robot.CloseNXT();
	}

}